asyncapi: '2.6.0'
info:
  title: Allocation Service
  version: 1.0.0
  description: Service responsible for managing product allocations and batches.

channels:
  change_batch_quantity:
    subscribe:
      summary: Getting a command to change the batch quantity
      description: The service subscribes to this channel to receive commands to change the quantity of goods in a specific batch.
      message:
        name: ChangeBatchQuantity
        contentType: application/json
        payload:
          type: object
          properties:
            batchref:
              type: string
              description: A link to the batch whose quantity needs to be changed.
              example: "batch-001"
            qty:
              type: integer
              description: The new quantity of goods in the batch.
              minimum: 1
              example: 50
          required:
            - batchref
            - qty
        examples:
          - name: example-change-batch-quantity
            payload:
              batchref: "batch-001"
              qty: 50

  line_allocated:
    publish:
      summary: Sending a product allocation event
      description: The service publishes this event after successfully allocating a product for an order.
      message:
        name: LineAllocated
        contentType: application/json
        payload:
          type: object
          properties:
            orderid:
              type: string
              description: The ID of the order for which the product was allocated.
              example: "order-123"
            SKU:
              type: string
              description: The SKU of the allocated product.
              example: "RED-CHAIR"
            batchref:
              type: string
              description: A link to the batch from which the product was allocated.
              example: "batch-001"
            qty:
              type: integer
              description: The quantity of the allocated product.
              minimum: 1
              example: 10
          required:
            - orderid
            - SKU
            - batchref
            - qty
        examples:
          - name: example-allocated-event
            payload:
              orderid: "order-123"
              SKU: "RED-CHAIR"
              batchref: "batch-001"
              qty: 10